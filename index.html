<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <!-- PWA / App Mode Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#020617">
    
    <!-- Custom SVG Icon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' rx='20' fill='%23020617'/%3E%3Crect x='20' y='45' width='25' height='25' rx='4' fill='%2338bdf8'/%3E%3Cpath d='M60 70 L80 70 L70 50 Z' fill='%23ef4444'/%3E%3Cpath d='M20 40 Q40 10 70 40' fill='none' stroke='%2338bdf8' stroke-width='4' stroke-dasharray='4 4'/%3E%3C/svg%3E">
    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' rx='20' fill='%23020617'/%3E%3Crect x='20' y='45' width='25' height='25' rx='4' fill='%2338bdf8'/%3E%3Cpath d='M60 70 L80 70 L70 50 Z' fill='%23ef4444'/%3E%3C/svg%3E">

    <title>Logan’s Geometrie Crash</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;900&family=Inter:wght@400;900&display=swap');
        
        body { 
            margin: 0; padding: 0; overflow: hidden; 
            background: #020617; touch-action: none; 
            font-family: 'Inter', sans-serif; color: white;
            user-select: none; -webkit-user-select: none;
        }

        canvas { 
            display: block; 
            position: absolute; top: 0; left: 0;
            z-index: 10;
        }

        .font-game { font-family: 'Orbitron', sans-serif; }

        #orientation-msg {
            display: none;
            position: fixed; inset: 0;
            background: #020617; z-index: 2000;
            flex-direction: column; align-items: center; justify-content: center;
            text-align: center; padding: 20px;
        }

        @media (orientation: portrait) {
            #orientation-msg { display: flex; }
        }

        .ui-layer {
            position: absolute; inset: 0;
            z-index: 100; pointer-events: none;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
        }

        .menu-box {
            background: rgba(2, 6, 23, 0.95);
            width: 100%; height: 100%;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            pointer-events: auto;
        }

        .controls-container {
            position: absolute; 
            bottom: 60px; 
            width: 100%; padding: 0 60px;
            display: flex; justify-content: space-between;
            align-items: flex-end;
            z-index: 150; pointer-events: none;
        }

        .ctrl-btn {
            background: rgba(255, 255, 255, 0.02); 
            border: 1px solid rgba(56, 189, 248, 0.1); 
            backdrop-filter: blur(1px);
            border-radius: 22px;
            display: flex; align-items: center; justify-content: center;
            pointer-events: auto;
            -webkit-tap-highlight-color: transparent;
            transition: transform 0.1s, background 0.1s;
        }

        .ctrl-btn:active {
            background: rgba(56, 189, 248, 0.2); 
            transform: scale(0.92);
        }

        .btn-arrow { width: 90px; height: 90px; font-size: 2.5rem; color: rgba(56, 189, 248, 0.2); }
        .btn-jump { width: 120px; height: 120px; border-radius: 50%; border-width: 2px; border-color: rgba(56, 189, 248, 0.15); }

        .btn-label {
            font-family: 'Orbitron', sans-serif;
            font-size: 11px; text-transform: uppercase;
            color: rgba(255, 255, 255, 0.1);
            letter-spacing: 2px;
        }

        .btn-menu {
            width: 220px; padding: 18px; margin: 10px;
            border-radius: 12px; font-weight: 900;
            text-transform: uppercase; letter-spacing: 2px;
            border: none; box-shadow: 0 5px 0 rgba(0,0,0,0.3);
            cursor: pointer; pointer-events: auto;
        }

        .hud-box {
            background: rgba(30, 41, 59, 0.3);
            padding: 8px 16px; border-radius: 12px;
            border: 1px solid rgba(56, 189, 248, 0.1);
            backdrop-filter: blur(2px);
        }

        #fs-toggle {
            position: fixed; top: 15px; right: 20px;
            z-index: 200; width: 45px; height: 45px;
            background: rgba(30, 41, 59, 0.3);
            border: 1px solid rgba(56, 189, 248, 0.1);
            border-radius: 8px; color: rgba(255,255,255,0.2);
            display: flex; align-items: center; justify-content: center;
            cursor: pointer;
        }
    </style>
</head>
<body>

    <div id="orientation-msg">
        <div class="text-sky-500 text-6xl mb-4 animate-pulse">↻</div>
        <h2 class="font-game text-xl uppercase italic">Bitte drehen</h2>
        <p class="text-slate-400 mt-2 max-w-xs">Logan’s Geometrie Crash wird im Querformat gespielt.</p>
    </div>

    <!-- Fullscreen Toggle -->
    <button id="fs-toggle" title="Vollbild" onclick="window.gameControl.toggleFullscreen()">
        <svg id="fs-icon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"></path>
        </svg>
    </button>

    <!-- UI LAYER -->
    <div id="ui-layer" class="ui-layer">
        <!-- Startmenü -->
        <div id="menu-start" class="menu-box">
            <h1 class="text-3xl md:text-6xl font-game font-black mb-1 italic uppercase tracking-tighter text-center">
                LOGAN'S <span class="text-sky-500">GEOMETRIE</span> CRASH
            </h1>
            <p class="text-slate-500 mb-8 text-[10px] tracking-[0.5em] uppercase font-bold text-center">Haptic Edition • v4.0</p>
            <div class="flex flex-row flex-wrap justify-center">
                <div class="flex flex-col items-center">
                    <button class="btn-menu bg-emerald-500 text-white font-game" onclick="window.gameControl.start('leicht')">Leicht</button>
                    <span class="text-[10px] text-emerald-400 uppercase font-bold" id="hs-leicht">Best: 0</span>
                </div>
                <div class="flex flex-col items-center">
                    <button class="btn-menu bg-amber-500 text-white font-game" onclick="window.gameControl.start('mittel')">Mittel</button>
                    <span class="text-[10px] text-amber-400 uppercase font-bold" id="hs-mittel">Best: 0</span>
                </div>
                <div class="flex flex-col items-center">
                    <button class="btn-menu bg-rose-500 text-white font-game" onclick="window.gameControl.start('schwer')">Schwer</button>
                    <span class="text-[10px] text-rose-400 uppercase font-bold" id="hs-schwer">Best: 0</span>
                </div>
            </div>
        </div>

        <!-- Crash Menü -->
        <div id="menu-crash" class="menu-box" style="display:none;">
            <h2 class="text-5xl font-game font-black text-rose-500 mb-2 italic uppercase text-center">System Crash</h2>
            <div class="text-8xl font-game font-black text-white mb-4" id="final-score">0</div>
            <div class="text-sky-400 text-xs font-bold uppercase mb-8 tracking-widest" id="new-record-msg" style="display:none;">NEUER REKORD!</div>
            <div class="flex flex-row space-x-4">
                <button class="btn-menu bg-sky-500 text-slate-950 font-game shadow-none" onclick="window.gameControl.start(window.currentDiff)">Nochmal</button>
                <button class="btn-menu bg-white text-slate-950 font-game shadow-none" onclick="window.gameControl.home()">Menü</button>
            </div>
        </div>
    </div>

    <!-- HUD -->
    <div id="hud" class="fixed top-4 left-6 flex space-x-4 z-[120] pointer-events-none" style="display:none;">
        <div class="hud-box">
            <div class="text-[9px] text-sky-400 uppercase font-black">Score</div>
            <div class="text-2xl font-black font-game leading-tight" id="live-score">0</div>
        </div>
        <div class="hud-box text-right">
            <div class="text-[9px] text-slate-400 uppercase font-black">Best (<span id="hud-mode-name">-</span>)</div>
            <div class="text-xl font-bold font-game leading-tight" id="hud-best">0</div>
        </div>
    </div>

    <!-- Controls -->
    <div id="controls" class="controls-container" style="display:none;">
        <div class="flex space-x-10">
            <div id="btn-L" class="ctrl-btn btn-arrow">←</div>
            <div id="btn-R" class="ctrl-btn btn-arrow">→</div>
        </div>
        <div>
            <div id="btn-J" class="ctrl-btn btn-jump"><span class="btn-label">Jump</span></div>
        </div>
    </div>

    <canvas id="gameCanvas"></canvas>

<script>
(function() {
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    
    // Core Engine State
    let audioCtx = null;
    let cw, ch, active = false, score = 0;
    let lastTime = 0;
    let spawnAccumulator = 0;
    let sideAccumulator = 0;

    const input = { L: false, R: false, J: false };
    const HS_PREFIX = 'logans_crash_hs_v40_final_';

    const ui = {
        start: document.getElementById('menu-start'),
        crash: document.getElementById('menu-crash'),
        controls: document.getElementById('controls'),
        hud: document.getElementById('hud'),
        live: document.getElementById('live-score'),
        final: document.getElementById('final-score'),
        hudBest: document.getElementById('hud-best'),
        hudMode: document.getElementById('hud-mode-name'),
        newRecord: document.getElementById('new-record-msg'),
        hsLabels: {
            leicht: document.getElementById('hs-leicht'),
            mittel: document.getElementById('hs-mittel'),
            schwer: document.getElementById('hs-schwer')
        }
    };

    const settings = {
        leicht: { jP: -12.5, spawnMs: 1450, sideMs: 4000, g: 0.38, speed: 9.0, color: '#10b981' },
        mittel: { jP: -11.5, spawnMs: 1050, sideMs: 3000, g: 0.44, speed: 10.5, color: '#f59e0b' },
        schwer: { jP: -10.5, spawnMs: 750, sideMs: 2200, g: 0.50, speed: 12.0, color: '#ef4444' }
    };

    const player = {
        x: 0, y: 0, size: 38, vy: 0, g: 0.42, jP: -12, 
        ground: 0, speed: 9, jumping: false, trail: []
    };

    let enemies = [], sides = [], fx = [];

    // --- Sound Synthesis Engine ---
    function initAudio() {
        if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        if (audioCtx.state === 'suspended') audioCtx.resume();
    }

    function playTone(freqStart, freqEnd, duration, type = 'sine', volume = 0.2) {
        if (!audioCtx) return;
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.type = type;
        osc.frequency.setValueAtTime(freqStart, audioCtx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(freqEnd, audioCtx.currentTime + duration);
        gain.gain.setValueAtTime(volume, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + duration);
        osc.connect(gain); gain.connect(audioCtx.destination);
        osc.start(); osc.stop(audioCtx.currentTime + duration);
    }

    // --- Haptics Engine (Vibration) ---
    const haptics = {
        jump: () => { if (navigator.vibrate) navigator.vibrate(12); },
        bonus: () => { if (navigator.vibrate) navigator.vibrate([30, 50, 30]); },
        crash: () => { if (navigator.vibrate) navigator.vibrate(150); }
    };

    const sound = {
        jump: () => playTone(220, 580, 0.15, 'sine', 0.1),
        bonus: () => {
            playTone(600, 1100, 0.1, 'sine', 0.15);
            setTimeout(() => playTone(800, 1500, 0.15, 'sine', 0.15), 50);
        },
        crash: () => playTone(350, 40, 0.45, 'sawtooth', 0.2)
    };

    function resize() {
        cw = window.innerWidth; ch = window.innerHeight;
        canvas.width = cw; canvas.height = ch;
        player.ground = ch - 55; 
        if(!active) { player.x = cw/2 - player.size/2; player.y = player.ground; }
    }
    window.addEventListener('resize', resize); resize();

    // Storage Management
    const getHS = (diff) => localStorage.getItem(HS_PREFIX + diff) || 0;
    const saveHS = (diff, s) => { 
        const best = parseInt(getHS(diff));
        if(s > best) { localStorage.setItem(HS_PREFIX + diff, s); return true; }
        return false;
    };
    const refreshHSDisplay = () => {
        Object.keys(settings).forEach(key => ui.hsLabels[key].innerText = "Best: " + getHS(key));
    };
    refreshHSDisplay();

    // PC Keys Support
    window.addEventListener('keydown', e => {
        if (!active) return;
        switch(e.code) {
            case 'ArrowLeft': case 'KeyA': input.L = true; break;
            case 'ArrowRight': case 'KeyD': input.R = true; break;
            case 'ArrowUp': case 'KeyW': case 'Space': input.J = true; triggerJump(); break;
        }
        if(['Space','ArrowUp','ArrowLeft','ArrowRight'].includes(e.code)) e.preventDefault();
    });
    window.addEventListener('keyup', e => {
        switch(e.code) {
            case 'ArrowLeft': case 'KeyA': input.L = false; break;
            case 'ArrowRight': case 'KeyD': input.R = false; break;
            case 'ArrowUp': case 'KeyW': case 'Space': input.J = false; break;
        }
    });

    // Mobile Input
    const bind = (id, key) => {
        const el = document.getElementById(id);
        el.addEventListener('touchstart', (e) => { 
            e.preventDefault(); 
            initAudio(); 
            input[key] = true; 
            if(key === 'J') triggerJump(); 
        }, {passive: false});
        el.addEventListener('touchend', (e) => { e.preventDefault(); input[key] = false; }, {passive: false});
    };
    bind('btn-L', 'L'); bind('btn-R', 'R'); bind('btn-J', 'J');

    window.gameControl = {
        start: (d) => {
            initAudio(); window.currentDiff = d; const s = settings[d];
            player.jP = s.jP; player.g = s.g; player.speed = s.speed;
            score = 0; spawnAccumulator = 0; sideAccumulator = 0;
            enemies = []; sides = []; fx = [];
            ui.live.innerText = "0"; ui.hudBest.innerText = getHS(d); ui.hudMode.innerText = d.toUpperCase();
            ui.start.style.display = 'none'; ui.crash.style.display = 'none'; ui.newRecord.style.display = 'none';
            ui.hud.style.display = 'flex'; ui.controls.style.display = 'flex';
            active = true;
            player.x = cw/2 - player.size/2; player.y = player.ground; player.vy = 0; player.jumping = false; player.trail = [];
            lastTime = performance.now();
        },
        home: () => { active = false; ui.crash.style.display = 'none'; ui.hud.style.display = 'none'; ui.controls.style.display = 'none'; ui.start.style.display = 'flex'; refreshHSDisplay(); },
        toggleFullscreen: () => { 
            if (!document.fullscreenElement) document.documentElement.requestFullscreen().catch(()=>{}); 
            else document.exitFullscreen(); 
        }
    };

    function triggerJump() {
        if(!player.jumping && active) { 
            player.vy = player.jP; 
            player.jumping = true; 
            sound.jump(); 
            haptics.jump();
            spawnFX(player.x + player.size/2, player.y + player.size, '#38bdf8', 12, 1); 
        }
    }

    function spawnFX(x, y, col, n, force) {
        for(let i=0; i<n; i++) fx.push({ x, y, vx:(Math.random()-0.5)*12*force, vy:(Math.random()-0.5)*12*force, l:1.0, col });
    }

    function spawnFirework(x, y) {
        sound.bonus(); 
        haptics.bonus();
        const colors = ['#fbbf24', '#f472b6', '#38bdf8', '#10b981', '#f59e0b', '#ffffff'];
        for(let i=0; i<60; i++) fx.push({ x, y, vx: (Math.random()-0.5)*25, vy: (Math.random()-0.5)*25, l: 1.5, col: colors[Math.floor(Math.random()*colors.length)] });
        fx.push({ x, y: y - 40, vx: 0, vy: -1.5, l: 2.0, col: '#fbbf24', text: '+5', isText: true });
    }

    function getRandomColor() { return `hsl(${Math.floor(Math.random() * 360)}, 70%, 55%)`; }

    function spawnEnemy() {
        let px = Math.random() * (cw - 80);
        const isSuper = Math.random() < 0.05; 
        let maxEvo = 1; if(score > 120) maxEvo = 3; else if(score > 45) maxEvo = 2;
        const evo = isSuper ? 1 : Math.ceil(Math.random() * maxEvo);
        const types = ['rect', 'circle', 'triangle', 'pentagon'];
        const type = isSuper ? 'star' : types[Math.floor(Math.random() * types.length)];
        enemies.push({ x: px, y: -100, size: isSuper ? 34 : (28 + Math.random()*22), speed: isSuper ? 2.5 : (3.2 + (score / 60)), rot: 0, rotS: (Math.random()-0.5)*0.1, evo, type, super: isSuper, color: isSuper ? '#fbbf24' : getRandomColor() });
    }

    function spawnSide() {
        const fromLeft = Math.random() > 0.5;
        sides.push({ x: fromLeft ? -60 : cw + 60, y: player.ground + (player.size - 32), size: 32, speed: fromLeft ? (5.5 + score/50) : -(5.5 + score/50), color: settings[window.currentDiff].color });
    }

    function update(dt) {
        if(!active) return;
        
        if(input.L) player.x -= player.speed * dt;
        if(input.R) player.x += player.speed * dt;
        
        player.x = Math.max(0, Math.min(cw - player.size, player.x));
        player.vy += player.g * dt; player.y += player.vy * dt;
        if(player.y >= player.ground) { player.y = player.ground; player.vy = 0; player.jumping = false; }
        player.trail.push({x: player.x, y: player.y}); if(player.trail.length > 8) player.trail.shift();

        const s = settings[window.currentDiff];
        const msPerFrame = dt * 16.66;
        spawnAccumulator += msPerFrame; sideAccumulator += msPerFrame;
        if(spawnAccumulator >= s.spawnMs) { spawnEnemy(); spawnAccumulator = 0; }
        if(sideAccumulator >= s.sideMs) { spawnSide(); sideAccumulator = 0; }

        enemies.forEach((e, i) => {
            e.y += e.speed * dt; e.rot += e.rotS * dt;
            if(checkHit(player, e)) { 
                if(e.super) { score += 5; ui.live.innerText = score; spawnFirework(e.x + e.size/2, e.y + e.size/2); enemies.splice(i, 1); } 
                else crash(); 
            }
            if(e.y > ch + 100) { enemies.splice(i, 1); if(!e.super) { score++; ui.live.innerText = score; } }
        });
        sides.forEach((e, i) => { e.x += e.speed * dt; if(checkHit(player, e)) crash(); if(e.x < -150 || e.x > cw + 150) sides.splice(i, 1); });
        fx.forEach((p, i) => { p.x += p.vx * dt; p.y += p.vy * dt; p.l -= 0.025 * dt; if(p.l <= 0) fx.splice(i, 1); });
    }

    function checkHit(p, o) {
        let b = o.size; if(o.evo === 2) b *= 1.45; if(o.evo === 3) b *= 1.85;
        const ox = o.x + o.size/2 - b/2; const oy = o.y + o.size/2 - b/2;
        return p.x + 6 < ox + b && p.x + p.size - 6 > ox && p.y + 6 < oy + b && p.y + p.size - 6 > oy;
    }

    function drawPolygon(x, y, radius, sides, rotation) {
        ctx.beginPath(); for (let i = 0; i < sides; i++) { const angle = rotation + (i * 2 * Math.PI) / sides; const px = x + radius * Math.cos(angle); const py = y + radius * Math.sin(angle); if (i === 0) ctx.moveTo(px, py); else ctx.lineTo(px, py); }
        ctx.closePath(); ctx.fill();
    }

    function crash() {
        active = false; 
        sound.crash(); 
        haptics.crash();
        spawnFX(player.x + player.size/2, player.y + player.size/2, '#ef4444', 35, 1);
        ui.final.innerText = score; ui.hud.style.display = 'none'; ui.controls.style.display = 'none'; ui.crash.style.display = 'flex';
        if(saveHS(window.currentDiff, score)) ui.newRecord.style.display = 'block';
    }

    function draw() {
        ctx.clearRect(0, 0, cw, ch);
        ctx.strokeStyle = '#1e293b'; ctx.lineWidth = 3; ctx.beginPath(); ctx.moveTo(0, player.ground + player.size); ctx.lineTo(cw, player.ground + player.size); ctx.stroke();
        
        fx.forEach(p => {
            ctx.globalAlpha = Math.max(0, p.l); ctx.fillStyle = p.col;
            if(p.isText) { ctx.font = `900 ${24 * p.l}px Orbitron`; ctx.fillText(p.text, p.x, p.y); } 
            else { ctx.fillRect(p.x, p.y, 4, 4); }
        });
        
        ctx.globalAlpha = 1;
        enemies.forEach(e => {
            ctx.save(); ctx.translate(e.x + e.size/2, e.y + e.size/2); ctx.rotate(e.rot); ctx.fillStyle = e.color;
            if(e.super) { const pulse = 1 + Math.sin(Date.now()/100)*0.1; ctx.scale(pulse, pulse); ctx.shadowBlur = 15; ctx.shadowColor = '#fbbf24'; drawPolygon(0,0,e.size/2,5,-Math.PI/2); }
            else {
                switch(e.type) { 
                    case 'rect': ctx.fillRect(-e.size/2,-e.size/2,e.size,e.size); break; 
                    case 'circle': ctx.beginPath(); ctx.arc(0,0,e.size/2,0,Math.PI*2); ctx.fill(); break; 
                    case 'triangle': drawPolygon(0,0,e.size/2,3,0); break; 
                    case 'pentagon': drawPolygon(0,0,e.size/2,5,0); break; 
                }
                if(e.evo >= 2) { ctx.globalAlpha = 0.6; const s = e.size*0.45; ctx.fillRect(-e.size/2-s,-s/2,s,s); ctx.fillRect(e.size/2,-s/2,s,s); ctx.fillRect(-s/2,-e.size/2-s,s,s); ctx.fillRect(-s/2,e.size/2,s,s); }
                if(e.evo >= 3) { ctx.strokeStyle = e.color; ctx.lineWidth = 2; ctx.beginPath(); ctx.arc(0,0,e.size*1.35,0,Math.PI*2); ctx.stroke(); ctx.globalAlpha = 0.4; ctx.fillRect(-e.size*1.65,-2,e.size*3.3,4); ctx.fillRect(-2,-e.size*1.65,4,e.size*3.3); }
            }
            ctx.restore(); ctx.shadowBlur = 0; ctx.globalAlpha = 1;
        });
        
        sides.forEach(e => { ctx.fillStyle = e.color; ctx.shadowBlur = 12; ctx.shadowColor = e.color; ctx.fillRect(e.x, e.y, e.size, e.size); ctx.shadowBlur = 0; });
        
        const tLen = player.trail.length;
        player.trail.forEach((t, i) => { ctx.globalAlpha = tLen > 0 ? (i / tLen) * 0.35 : 0; ctx.fillStyle = '#38bdf8'; ctx.fillRect(t.x, t.y, player.size, player.size); });
        
        ctx.globalAlpha = 1; ctx.fillStyle = '#38bdf8'; ctx.shadowBlur = 15; ctx.shadowColor = '#38bdf8';
        ctx.fillRect(player.x, player.y, player.size, player.size); ctx.shadowBlur = 0;
        ctx.fillStyle = '#020617'; ctx.fillRect(player.x+8, player.y+10, 5, 5); ctx.fillRect(player.x+player.size-13, player.y+10, 5, 5);
    }

    function loop(now) {
        if (!lastTime) lastTime = now; const delta = now - lastTime; lastTime = now;
        update(Math.min(delta / 16.66, 2.2)); draw();
        requestAnimationFrame(loop);
    }
    requestAnimationFrame(loop);
})();
</script>
</body>
</html>
